{"ast":null,"code":"const mongoose = require(\"mongoose\");\n\nconst validator = require(\"validator\");\n\nconst bcrypt = require(\"bcryptjs\");\n\nconst userSchema = new mongoose.Schema({\n  email: {\n    type: String,\n    required: [true, \"please tell us your email\"],\n    unique: true,\n    lowercase: true,\n    validate: [validator.isEmail, \"please provie a valid email\"]\n  },\n  photo: String,\n  password: {\n    type: String,\n    required: [true, \"please provie password\"],\n    minlength: 8,\n    select: false // to not show up in any output\n\n  },\n  passwordConfirm: {\n    type: String,\n    required: [true, \"please confirm your password\"],\n    validate: {\n      //this only works on CREATE N SAVE!!\n      validator: function (el) {\n        return el === this.password; // el is the passwordConfirm eg: abc === abc will return true\n      },\n      message: \"passwords are not the same\"\n    }\n  }\n});\nuserSchema.pre(\"save\", async function (next) {\n  this.password = await bcrypt.hash(this.password, 12);\n  this.passwordConfirm = undefined;\n  next();\n});\n\nuserSchema.methods.correctPassword = async function (candidatePassword, userPassword) {\n  return await bcrypt.compare(candidatePassword, userPassword);\n};\n\nconst User = mongoose.model(\"User\", userSchema);\nmodule.exports = mongoose.models.Users || mongoose.model(\"Users\", userSchema);","map":{"version":3,"sources":["C:/Users/USER/Desktop/isave/server/models/userModel.js"],"names":["mongoose","require","validator","bcrypt","userSchema","Schema","email","type","String","required","unique","lowercase","validate","isEmail","photo","password","minlength","select","passwordConfirm","el","message","pre","next","hash","undefined","methods","correctPassword","candidatePassword","userPassword","compare","User","model","module","exports","models","Users"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAMC,SAAS,GAAGD,OAAO,CAAC,WAAD,CAAzB;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,UAAD,CAAtB;;AAEA,MAAMG,UAAU,GAAG,IAAIJ,QAAQ,CAACK,MAAb,CAAoB;AACrCC,EAAAA,KAAK,EAAE;AACLC,IAAAA,IAAI,EAAEC,MADD;AAELC,IAAAA,QAAQ,EAAE,CAAC,IAAD,EAAO,2BAAP,CAFL;AAGLC,IAAAA,MAAM,EAAE,IAHH;AAILC,IAAAA,SAAS,EAAE,IAJN;AAKLC,IAAAA,QAAQ,EAAE,CAACV,SAAS,CAACW,OAAX,EAAoB,6BAApB;AALL,GAD8B;AAQrCC,EAAAA,KAAK,EAAEN,MAR8B;AAUrCO,EAAAA,QAAQ,EAAE;AACRR,IAAAA,IAAI,EAAEC,MADE;AAERC,IAAAA,QAAQ,EAAE,CAAC,IAAD,EAAO,wBAAP,CAFF;AAGRO,IAAAA,SAAS,EAAE,CAHH;AAIRC,IAAAA,MAAM,EAAE,KAJA,CAIO;;AAJP,GAV2B;AAiBrCC,EAAAA,eAAe,EAAE;AACfX,IAAAA,IAAI,EAAEC,MADS;AAEfC,IAAAA,QAAQ,EAAE,CAAC,IAAD,EAAO,8BAAP,CAFK;AAGfG,IAAAA,QAAQ,EAAE;AACR;AACAV,MAAAA,SAAS,EAAE,UAAUiB,EAAV,EAAc;AACvB,eAAOA,EAAE,KAAK,KAAKJ,QAAnB,CADuB,CACM;AAC9B,OAJO;AAKRK,MAAAA,OAAO,EAAE;AALD;AAHK;AAjBoB,CAApB,CAAnB;AA8BAhB,UAAU,CAACiB,GAAX,CAAe,MAAf,EAAuB,gBAAgBC,IAAhB,EAAsB;AAC3C,OAAKP,QAAL,GAAgB,MAAMZ,MAAM,CAACoB,IAAP,CAAY,KAAKR,QAAjB,EAA2B,EAA3B,CAAtB;AAEA,OAAKG,eAAL,GAAuBM,SAAvB;AAEAF,EAAAA,IAAI;AACL,CAND;;AAQAlB,UAAU,CAACqB,OAAX,CAAmBC,eAAnB,GAAqC,gBAAgBC,iBAAhB,EAAmCC,YAAnC,EAAiD;AACpF,SAAO,MAAMzB,MAAM,CAAC0B,OAAP,CAAeF,iBAAf,EAAkCC,YAAlC,CAAb;AACD,CAFD;;AAIA,MAAME,IAAI,GAAG9B,QAAQ,CAAC+B,KAAT,CAAe,MAAf,EAAuB3B,UAAvB,CAAb;AAEA4B,MAAM,CAACC,OAAP,GAAiBjC,QAAQ,CAACkC,MAAT,CAAgBC,KAAhB,IAAyBnC,QAAQ,CAAC+B,KAAT,CAAe,OAAf,EAAwB3B,UAAxB,CAA1C","sourcesContent":["const mongoose = require(\"mongoose\");\r\nconst validator = require(\"validator\");\r\nconst bcrypt = require(\"bcryptjs\");\r\n\r\nconst userSchema = new mongoose.Schema({\r\n  email: {\r\n    type: String,\r\n    required: [true, \"please tell us your email\"],\r\n    unique: true,\r\n    lowercase: true,\r\n    validate: [validator.isEmail, \"please provie a valid email\"],\r\n  },\r\n  photo: String,\r\n\r\n  password: {\r\n    type: String,\r\n    required: [true, \"please provie password\"],\r\n    minlength: 8,\r\n    select: false, // to not show up in any output\r\n  },\r\n\r\n  passwordConfirm: {\r\n    type: String,\r\n    required: [true, \"please confirm your password\"],\r\n    validate: {\r\n      //this only works on CREATE N SAVE!!\r\n      validator: function (el) {\r\n        return el === this.password; // el is the passwordConfirm eg: abc === abc will return true\r\n      },\r\n      message: \"passwords are not the same\",\r\n    },\r\n  },\r\n});\r\n\r\nuserSchema.pre(\"save\", async function (next) {\r\n  this.password = await bcrypt.hash(this.password, 12);\r\n\r\n  this.passwordConfirm = undefined;\r\n\r\n  next();\r\n});\r\n\r\nuserSchema.methods.correctPassword = async function (candidatePassword, userPassword) {\r\n  return await bcrypt.compare(candidatePassword, userPassword);\r\n};\r\n\r\nconst User = mongoose.model(\"User\", userSchema);\r\n\r\nmodule.exports = mongoose.models.Users || mongoose.model(\"Users\", userSchema);\r\n"]},"metadata":{},"sourceType":"script"}