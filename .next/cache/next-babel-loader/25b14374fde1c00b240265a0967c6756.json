{"ast":null,"code":"import { create } from \"./server/models/userModel\";\nexport const addFirstProduct = product => {\n  let productPrice = product.price; //create an empty array and push the item\n\n  let newCart = {\n    products: [],\n    totalProductsCount: 1,\n    totalProductsPrice: +productPrice\n  };\n  const newProduct = createNewProduct(product, productPrice, 1);\n  newCart.products.push(newProduct);\n  localStorage.setItem(\"isavecart\", JSON.stringify(newCart));\n  return newCart;\n}; // create a new product object\n\nexport const createNewProduct = (product, productPrice, qty) => {\n  return {\n    productId: product._id,\n    image: product.image,\n    price: productPrice,\n    name: product.name,\n    qty: qty,\n    totalPrice: productPrice * qty\n  };\n};\nexport const updateCart = (existingCart, product, qtytoBeAdded, newQty = false) => {\n  const updatedProducts = getUpdatedProducts(existingCart.products, product, qtytoBeAdded, newQty);\n  console.log(\"updatedProducts\", updatedProducts);\n\n  const addPrice = (total, item) => {\n    total.totalPrice += item.totalPrice;\n    total.qty += item.qty;\n    return total;\n  }; //loop through the updated proudct array and add the totALprice of each item to get the totalPrice\n\n\n  let total = updatedProducts.reduce(addPrice, {\n    totalPrice: 0,\n    qty: 0\n  });\n  const updatedCart = {\n    products: updatedProducts,\n    totalProductsCount: +total.qty,\n    totalProductsPrice: +total.totalPrice\n  };\n  localStorage.setItem(\"isavecart\", JSON.stringify(updatedCart));\n  return updatedCart;\n}; //get updated products array\n//update the product if its exist\n//and add the new product to the existing cart\n\nexport const getUpdatedProducts = (existingProductInCart, product, qtyToBeAdded, newQty = false) => {\n  const productExistIndex = isProductInCart(existingProductInCart, product._id); //if product exist (index of that product is found in te array) update the product qunatity and totalPrice\n\n  if (-1 < productExistIndex) {\n    let updatedProducts = existingProductInCart;\n    let updatedProduct = updatedProducts[productExistIndex]; //if we have the new quantity of the product avail, se that else add the qtyToBeAdded\n\n    updatedProduct.qty = newQty ? newQty : updatedProduct.qty + qtyToBeAdded;\n    updatedProduct.totalPrice = updatedProduct.price * updatedProduct.qty; // updatedProduct.totalPrice = updatedProduct.price * updatedProduct.qty;\n\n    return updatedProducts;\n  } else {\n    //if the product is not found push the new product to the existing product array\n    let productPrice = product.price;\n    const newProduct = createNewProduct(product, productPrice, qtyToBeAdded);\n    existingProductInCart.push(newProduct);\n    return existingProductInCart;\n  }\n}; //return index of the product if it exists\n\nexport const isProductInCart = (existingProductInCart, productId) => {\n  console.log(\"existingProductInCart\", existingProductInCart);\n\n  const returnItemThatExists = (item, index) => {\n    if (productId === item.productId) {\n      return item;\n    }\n  };\n\n  const newArray = existingProductInCart.filter(returnItemThatExists);\n  return existingProductInCart.indexOf(newArray[0]);\n};","map":null,"metadata":{},"sourceType":"module"}