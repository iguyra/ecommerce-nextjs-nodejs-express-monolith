{"ast":null,"code":"const axios = require(\"axios\");\n\nconst User = require(\"./models/userModel\");\n\nconst jwt = require(\"jsonwebtoken\");\n\nexports.signup = async (req, res, next) => {\n  try {\n    const {\n      email,\n      password,\n      passwordConfirm\n    } = req.body;\n    const newUser = await User.create({\n      email,\n      password,\n      passwordConfirm\n    });\n    const token = jwt.sign({\n      id: newUser._id\n    }, process.env.JWT_SECRET, {\n      expiresIn: process.env.JWT_EXPIRES_IN\n    });\n    const cookieOptions = {\n      expires: new Date(Date.now() + process.env.JWT_COOKIE_EXPIRES_IN * 24 * 60 * 60 * 1000),\n      // secure: true,\n      httpOnly: true //converted to milliseconds\n\n    };\n    res.cookie(\"jwt\", token, cookieOptions);\n    console.log(\"account created\");\n    res.status(201).json({\n      status: \"success\",\n      token: token,\n      data: {\n        newUser\n      }\n    });\n  } catch (err) {\n    console.log(\"errrorr\", err);\n  }\n};\n\nexports.login = async (req, res) => {\n  const {\n    email,\n    password\n  } = req.body;\n  const user = await User.findOne({\n    email\n  }).select(\"+password\");\n\n  if (!email || !password) {\n    return console.log(\"please type credientials\");\n  }\n\n  if (!user || !(await user.correctPassword(password, user.password))) {\n    return console.log(\"user does not exist, try again\");\n  }\n\n  console.log(\"account found\");\n  const token = jwt.sign({\n    id: user._id\n  }, process.env.JWT_SECRET, {\n    expiresIn: process.env.JWT_EXPIRES_IN\n  });\n  const cookieOptions = {\n    expires: new Date(Date.now() + process.env.JWT_COOKIE_EXPIRES_IN * 24 * 60 * 60 * 1000),\n    // secure: true,\n    httpOnly: true //converted to milliseconds\n\n  };\n  res.cookie(\"jwt\", token, cookieOptions);\n  console.log(\"user signed\");\n  res.status(201).json({\n    status: \"success\",\n    token: token,\n    data: {\n      user\n    }\n  });\n};\n\nexports.protected = (req, res) => {\n  console.log(\"ressss\", req);\n  const user = {\n    name: \"res\"\n  };\n  res.json({\n    user\n  });\n};","map":null,"metadata":{},"sourceType":"script"}