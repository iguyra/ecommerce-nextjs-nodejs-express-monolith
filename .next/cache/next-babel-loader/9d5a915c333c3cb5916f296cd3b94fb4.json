{"ast":null,"code":"var _regeneratorRuntime = require(\"@babel/runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"@babel/runtime/helpers/asyncToGenerator\");\n\nvar mongoose = require(\"mongoose\");\n\nvar validator = require(\"validator\");\n\nvar bcrypt = require(\"bcryptjs\");\n\nvar userSchema = new mongoose.Schema({\n  email: {\n    type: String,\n    required: [true, \"please tell us your email\"],\n    unique: true,\n    lowercase: true,\n    validate: [validator.isEmail, \"please provie a valid email\"]\n  },\n  photo: String,\n  password: {\n    type: String,\n    required: [true, \"please provie password\"],\n    minlength: 8,\n    select: false // to not show up in any output\n\n  },\n  passwordConfirm: {\n    type: String,\n    required: [true, \"please confirm your password\"],\n    validate: {\n      //this only works on CREATE N SAVE!!\n      validator: function validator(el) {\n        return el === this.password; // el is the passwordConfirm eg: abc === abc will return true\n      },\n      message: \"passwords are not the same\"\n    }\n  }\n});\nuserSchema.pre(\"save\", /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(next) {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return bcrypt.hash(this.password, 12);\n\n          case 2:\n            this.password = _context.sent;\n            this.passwordConfirm = undefined;\n            next();\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}());\n\nuserSchema.methods.correctPassword = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(candidatePassword, userPassword) {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return bcrypt.compare(candidatePassword, userPassword);\n\n          case 2:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 3:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x2, _x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar User = mongoose.model(\"User\", userSchema);\nmodule.exports = User;","map":{"version":3,"sources":["C:/Users/USER/Desktop/isave/server/models/userModel.js"],"names":["mongoose","require","validator","bcrypt","userSchema","Schema","email","type","String","required","unique","lowercase","validate","isEmail","photo","password","minlength","select","passwordConfirm","el","message","pre","next","hash","undefined","methods","correctPassword","candidatePassword","userPassword","compare","User","model","module","exports"],"mappings":";;;;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,IAAMC,SAAS,GAAGD,OAAO,CAAC,WAAD,CAAzB;;AACA,IAAME,MAAM,GAAGF,OAAO,CAAC,UAAD,CAAtB;;AAEA,IAAMG,UAAU,GAAG,IAAIJ,QAAQ,CAACK,MAAb,CAAoB;AACrCC,EAAAA,KAAK,EAAE;AACLC,IAAAA,IAAI,EAAEC,MADD;AAELC,IAAAA,QAAQ,EAAE,CAAC,IAAD,EAAO,2BAAP,CAFL;AAGLC,IAAAA,MAAM,EAAE,IAHH;AAILC,IAAAA,SAAS,EAAE,IAJN;AAKLC,IAAAA,QAAQ,EAAE,CAACV,SAAS,CAACW,OAAX,EAAoB,6BAApB;AALL,GAD8B;AAQrCC,EAAAA,KAAK,EAAEN,MAR8B;AAUrCO,EAAAA,QAAQ,EAAE;AACRR,IAAAA,IAAI,EAAEC,MADE;AAERC,IAAAA,QAAQ,EAAE,CAAC,IAAD,EAAO,wBAAP,CAFF;AAGRO,IAAAA,SAAS,EAAE,CAHH;AAIRC,IAAAA,MAAM,EAAE,KAJA,CAIO;;AAJP,GAV2B;AAiBrCC,EAAAA,eAAe,EAAE;AACfX,IAAAA,IAAI,EAAEC,MADS;AAEfC,IAAAA,QAAQ,EAAE,CAAC,IAAD,EAAO,8BAAP,CAFK;AAGfG,IAAAA,QAAQ,EAAE;AACR;AACAV,MAAAA,SAAS,EAAE,mBAAUiB,EAAV,EAAc;AACvB,eAAOA,EAAE,KAAK,KAAKJ,QAAnB,CADuB,CACM;AAC9B,OAJO;AAKRK,MAAAA,OAAO,EAAE;AALD;AAHK;AAjBoB,CAApB,CAAnB;AA8BAhB,UAAU,CAACiB,GAAX,CAAe,MAAf;AAAA,sEAAuB,iBAAgBC,IAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACCnB,MAAM,CAACoB,IAAP,CAAY,KAAKR,QAAjB,EAA2B,EAA3B,CADD;;AAAA;AACrB,iBAAKA,QADgB;AAGrB,iBAAKG,eAAL,GAAuBM,SAAvB;AAEAF,YAAAA,IAAI;;AALiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAvB;;AAAA;AAAA;AAAA;AAAA;;AAQAlB,UAAU,CAACqB,OAAX,CAAmBC,eAAnB;AAAA,uEAAqC,kBAAgBC,iBAAhB,EAAmCC,YAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACtBzB,MAAM,CAAC0B,OAAP,CAAeF,iBAAf,EAAkCC,YAAlC,CADsB;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAArC;;AAAA;AAAA;AAAA;AAAA;;AAIA,IAAME,IAAI,GAAG9B,QAAQ,CAAC+B,KAAT,CAAe,MAAf,EAAuB3B,UAAvB,CAAb;AACA4B,MAAM,CAACC,OAAP,GAAiBH,IAAjB","sourcesContent":["const mongoose = require(\"mongoose\");\r\nconst validator = require(\"validator\");\r\nconst bcrypt = require(\"bcryptjs\");\r\n\r\nconst userSchema = new mongoose.Schema({\r\n  email: {\r\n    type: String,\r\n    required: [true, \"please tell us your email\"],\r\n    unique: true,\r\n    lowercase: true,\r\n    validate: [validator.isEmail, \"please provie a valid email\"],\r\n  },\r\n  photo: String,\r\n\r\n  password: {\r\n    type: String,\r\n    required: [true, \"please provie password\"],\r\n    minlength: 8,\r\n    select: false, // to not show up in any output\r\n  },\r\n\r\n  passwordConfirm: {\r\n    type: String,\r\n    required: [true, \"please confirm your password\"],\r\n    validate: {\r\n      //this only works on CREATE N SAVE!!\r\n      validator: function (el) {\r\n        return el === this.password; // el is the passwordConfirm eg: abc === abc will return true\r\n      },\r\n      message: \"passwords are not the same\",\r\n    },\r\n  },\r\n});\r\n\r\nuserSchema.pre(\"save\", async function (next) {\r\n  this.password = await bcrypt.hash(this.password, 12);\r\n\r\n  this.passwordConfirm = undefined;\r\n\r\n  next();\r\n});\r\n\r\nuserSchema.methods.correctPassword = async function (candidatePassword, userPassword) {\r\n  return await bcrypt.compare(candidatePassword, userPassword);\r\n};\r\n\r\nconst User = mongoose.model(\"User\", userSchema);\r\nmodule.exports = User;\r\n"]},"metadata":{},"sourceType":"script"}